var request = require('request');
var $ = require('jquery');
var indexURL = 'http://www.jw.org/pl/publikacje/biblia/nwt/ksi%C4%99gi-biblijne/';
var chaptersURL = 'http://www.jw.org/pl/publikacje/biblia/nwt/ksi%C4%99gi-biblijne/json/filters/BibleChapterViewsFilter/?Book=';
var data = {};


function loadChapters(book) {
  request(chaptersURL + book.nom function (err, res, body) {
    if (err || res.statusCode !== 200) {
      console.log('err', err);
    }

    JSON.parse(body).choices.forEach(function (choice) {
      book.chapters[choice.optionValue] = 0;
    });
  });

}


request(indexURL, function (err, res, body) {
  if (err || res.statusCode !== 200) {
    console.log('err', err);
  }

  var $body = $(body);
  
  $body.find('.jsPublicationFilter[name=Book] option').each(function () {
    var $option = $(this);
    
    data[$option.val()] = {
      no: $option.val(),
      translations: {
        pl: {
          long: $option.text()
        }
      },
      chapters: {}
    };
  });

})